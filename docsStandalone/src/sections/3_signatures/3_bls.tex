% d. BLS:   [Alireza]
% ยง Mention target curve for each algorithm
% ยง Signing modes
% Briefly mention use-cases
% ---------------------------------------------------------------------------- %
\subsection{BLS}\label{sec:bls}
% ---------------------------------------------------------------------------- %


The Boneh-Lynn-Shacham (BLS) signature scheme~\cite{boneh2001short} is a deterministic, non-malleable, and efficient signature scheme grounded on pairing-based cryptography, resorting to a type III bilinear pairing $\fn{e}\!: \G_1 \times \G_2 \rightarrow \G_T$ for signature verification. Subject of an RFC draft~\cite{irtf_bls_signature_05}, the BLS signature scheme is provably secure (the scheme is \textit{existentially unforgeable} under \textit{adaptive chosen-message attacks}) in the random oracle model assuming hardness of a variant of the computational Diffie-Hellman problem. $\G_1$ and $\G_2$ are elliptic curve groups with the same characteristic $q$ defined over fields of order $p$ and $p^2$ respectively, and $\G_T$ is a target group over a field of order $p^{12}$.

\input{src/algorithms/signatures/bls}

Based on the choice of what group to use for what scheme element, BLS supports two modes of operation:
\begin{itemize}
    \item \textbf{Short public keys, long signatures}: Signatures are longer and slower to create, verify, and aggregate but public keys are small and fast to aggregate. Used when signing and verification operations not computed as often or for minimizing storage or bandwidth for public keys. $\G_1$ is used as the key group, and $\G_2$ as the signature group. 
    \item \textbf{Short signatures, long public keys}: Signatures are short and fast to create, verify, and aggregate but public keys are bigger and slower to aggregate. Used when signing and verification operations are computed often or for minimizing storage or bandwidth for signatures. $\G_2$ is used as the key group, and $\G_1$ as the signature group.
\end{itemize}

The BLS signature can be composed into a multi-signature scheme with batch verification. To do so, an additional mechanism must be introduced to prevent rogue public-key attacks (i.e., a malicious party can carefully craft a signature that negates the contributions of other parties and reveals a secret key). The BLS signature scheme supports three rogue key prevention schemes: 

\begin{enumerate}
    \item \textbf{Basic}: Requiring all messages to be unique.
    \item \textbf{Message Augmentation}: Prepends the public key of the signer to the message thereby making each message unique.
    \item \textbf{Proof of Possession (PoP)}: Every signature is accompanied by a signature of the public key acts as proof of possession of its secret key.
\end{enumerate}

We diverge slightly from \cite{irtf_bls_signature_05} by employing an optimization trick on the final exponentiation\footnote{From \url{https://hackmd.io/benjaminion/bls12-381\#Final-exponentiation}}. Crucially, we also include the message hashing as part of the verification process in order to avoid some attacks. %TODO: add reference