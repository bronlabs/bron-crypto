% a. KeyGen.  [Alberto]
% i. trusted dealer
%     □ Where is is used
% ii. DKG:
%     □ Gennaro only (why not Pedersen - bias) --> Changing to our version of Gennaro (
%     □ Mention differences with the paper (no robustness and complaint process)
%     □ Add changes for taproot
% Mention how we’re using it for Key Refresh

\subsection{Distributed Key Generation}\label{sec:key_generation}

All signature schemes presented in \autoref{sec:signatures} are based on the prior existence of a scalar private key $x \in \Z_{q^*}$, and its corresponding public key $ \g{Y} = x \cdot \g{G} \in \G$. In the standalone case, where one single party is to be the sole signer, the key generation is trivial, relying on a \textit{Trusted Dealer} such as the one in Algorithm \ref{alg:trusteddealer}. In this toy scenario, a single party generates the private key and distributes the \textit{shards}.


\input{src/algorithms/threshold_signatures/trusted_dealer.tex}

In contrast, in the multi-party case known as Distributed Key Generation (\fndef{DKG}) with $n$ parties holding private key shares (a.k.a. \textit{shards}), the private key may not even exist in one place. The secret key ownership is distributed  over the participants of the \fn{DKG}, and public key needs to be derived from these \textit{shards}. 


A DKG protocol should be used for almost all use cases. In contrast, the trusted dealer should only be used for debugging purposes, for specific legacy systems and for informed clients that explicitly require it. Trusted-dealer setup is strictly less secure, and careful thought should be given to the setup context (e.g., using a Trusted Execution Environment), to the erasure of secrets, and to the distribution of the shares. We leave the details out of this document, as they are highly context-dependent.

We employ two main methods from the literature to generate the private key shares: The \fnref{PedersenDKG} and the \fn{Gennaro} \fnref[gennarodkg]{DKG}. They are both protected against \textit{rogue key attacks}, whereby a \textit{rushing adversary} might wait until it receives all the public key shares from honest participants and construct its own share maliciously to bias the public key or even break the security of the scheme.

\subsubsection{Pedersen DKG} \label{sec:pedersen_dkg}

The \fnref{PedersenDKG} from \cite{pedersen91dkg} outlines a two-round DKG based on  $t$-out-of-$n$ \fnref{Feldman} VSS. Following the standard practices for equivalent DKGs~\cite{lindell17,DKLs19,doerner2023zero,chen2024feldman} we include a ZKPoK (via \idealfn[ZK]{R_{DL}}) of each secret key share and of each of the VSS shares, as a means to thwart \textit{rogue key attacks}. Protocol \ref{alg:pedersendkg} describes this approach.

\input{src/algorithms/threshold_signatures/pedersen_dkg.tex}

\subsubsection{Gennaro DKG} \label{sec:gennaro_dkg}

The \fn{Gennaro} \fnref[gennarodkg]{DKG}, a DKG described in Protocol \ref{alg:gennarodkg}. This DKG protocol follows \cite{gennaroDKG}, employing Pedersen commitments~\cite[Section 3]{pedersen1991vss} to prevent bias while enhancing the security with an additional ZKPoK of the discrete log of their secret share to protect against rogue-key attacks~\cite{jarecki2000adaptively,BBS03}. Following \cite{chen2024feldman}, we enhance the original protocol by providing ZKPoKs not only for the commitment of the free coefficient, but for all the coefficients and commitments. We remove the blaming and blamed share reconstruction steps from Gennaro DKG as in \cite{chen2024feldman}, since our threat model does not cover robustness.

\input{src/algorithms/threshold_signatures/gennaro_dkg.tex}

