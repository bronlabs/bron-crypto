    
\begin{algorithm}[H]
    \caption{$\quad$\fndef[ecdsa]{ECDSA.RecoverPublicKey}}
    \label{alg:ecdsa_recoverpk}
    \begin{algorithmic}[1] 
        \Require {  a message $m$, and  a signature $\sigma \equals (r \ins \Z_{q^*}, s \ins \Z_{q^*}, v\ins \Z_4)$ }
        \Ensure { $\g{Q}$, the public key. }

        \State $\assign{\g{R}_x}{r + q(v \mod 2)}$
        \State $\g{R}_y$ s.t. $\g{R}=(\g{R}_x, \g{R}_y) \in \G$. \Comment{(Use the curve equation)}
        \State Check $\isequal{\g{R}_y \mod 2}{v \mod 2}$ and $\ABORT$ if not
        \State $\assign{d}{\fn{sha256}(m)}$ and $\assign{m'}{(d \mod 2^{|q|})}$, the $|q|$ leftmost bits of $d$
        \State $\g{Q} = r^{-1}(s \cdot \g{R} - m' \cdot \g{G})$
        \State Check that $\fn{Verify}(\g{Q}, m, \sigma)$ is \textit{valid}, $\ABORT$ if not
        \Statex \Return $\g{Q}$
        
    \end{algorithmic}
\end{algorithm}
