\begin{scheme}[H]
    \caption{$\quad\fn{Pedersen}\; \fndef[dlc]{Commitment}\;\fn{(PC)}$} \label{alg:pedersen_commitment}
    \begin{algorithmic}[1]
    \begin{alginfo}
        The commitment scheme from \cite[Section3]{pedersen1991vss} parametrized by a group $\G$ of prime order $q$ with a generator $\g{G}$ (e.g., an elliptic curve $\fn{E}(\G, q, \g{G})$), and a second generator $\g{H}$ chosen independently\footnotemark from $\g{G}$. 
    \end{alginfo}
    \Require $m$, an input message to commit and later open.
        
    \Ensure {
        \textit{valid} if the commitment is verified correctly.
    }

    \vspace{-10pt}
    \AlgFnctZero{\fndef[dlc]{Commit}}{}{$m \ins \Z_q$}{$(\g{C},w)$}
        \State Sample $\sample{w}{\Z_q}$, a random witness
        \State $\assign{\g{C}}{w\cdot \g{G} + m\cdot \g{H}}$ as the commitment of $m$.
        \Statex \Return $(\g{C},w)$
    \vspace{-12pt}
    \AlgFnct{\fndef[dlc]{Open}}{}{$m,\g{C},w$}{\textit{valid}}
    \setalglineno{1}
        \State $\assign{c'}{m\cdot \g{G} + w\cdot \g{H}}$
        \Statex \Return \textit{valid} if $\isequal{c}{c'}$, $\ABORT$ otherwise.
    \end{algorithmic}
\end{scheme}
\footnotetext{Such that nobody knows $x$ s.t. $\g{H} = x \cdot \g{G}$. This can effectively achieved via aggregation of commitments of independent random values following the instructions of~\cite{pedersen1991vss}, or via $\assign{\g{H}}{\fn{Hash2Curve}(m)}$ of a fixed message $m$ (e.g., $m = \str{NOTHING_UP_MY_SLEEVE})$ as we do.}
