\begin{protocol}[ht]
    \caption{$\quad$\fn{AgreeOnRandom}}\label{alg:agreeonrandom}
    \begin{algorithmic}[1]
        \begin{alginfo}
            A protocol inspired by~\cite{ben2015crsSampling} to sample a uniformly random value $r$ among $n$ parties. It requires a commitment scheme (e.g., Scheme \ref{alg:commitment}), a broadcast channel $\idealfnref{Broadcast}$ and a hash function $\fn{H}$ (e.g., SHA-256~\cite{FIPS202}, a \fnref{Transcript})
        \end{alginfo} 
        
        \Players { $\party{1}, \dots,\party{i},\dots,\party{n}$ }

        \Ensure {$r$, a random value}

        \vspace{-8pt}
        \AlgRoundZero{\hspace{-2pt}$\party{i}$}{\fn{Round1}}{}{$c_i$}
        \State Sample $\sample{r_i}{\Z_{q^*}}$ as the random value of $\party{i}$.
        \State Run $\assign{(c_i, w_i)}{\fn{Commit}(r_i)}$ to get the commitment $c_i$ and the witness $w_i$.
        \State $\idealfnref{Broadcast}(c_i)$ to distribute all commitments $c_i$ to all parties.

        \vspace{-8pt}
        \setalglineno{1}
        \AlgRound{\hspace{-2pt}$\party{i}$}{\fn{Round2}}{$\vect{c}=\{c_1,c_2,...,c_n\}$}{$r_i, w_i$}
        \State $\idealfnref{Broadcast}(r_i, w_i)$ to reveal $r_i$ and $w_i$ to all parties.

        \vspace{-8pt}
        \setalglineno{1}
        \AlgRound{\hspace{-2pt}$\party{i}$}{\fn{Round3}}{$\vect{c}=\{c_1,c_2,...,c_n\},\vect{r}=\{r_1,r_2,...,r_n\}, \vect{w}=\{w_1,w_2,...,w_n\}$}{$r$}
        \For{$i \in \range{n}$}
            \State $\fn{Open}(r_i, c_i, w_i)$, $\ABORT$ if it fails.
        \EndFor
        \State $\assign{r}{\fn{H}(\vect{r})}$
        \Statex \Return $r$

    \end{algorithmic}
\end{protocol}
