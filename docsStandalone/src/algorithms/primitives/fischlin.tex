
\begin{scheme}[ht]
    \caption{$\quad$\fndef{Fischlin}} \label{alg:fischlin}
    \begin{algorithmic}[1]
    \begin{alginfo}
        A transformation from an Interactive Sigma Protocol $\bm{\Sigma}_\text{R}$ into a Non-Interactive (NI) proof system following \cite{fischlinTransform}, parametrized by a hash function\footnotemark $\fn{H}_\ell\!: \{0,1\}^* \mapsto \Z_2^\ell$ with digest length of $\ell$ bits (we set $\ell\equals8$).
    \end{alginfo} 
    
    \vspace{-8pt}
    \AlgFnct{\fndef[fischlin]{Prove}}{}{$\text{R}, w$}{$\pi$}
        \For {$i \in \range{\lambda/\ell}$}
            \State $\assign{(a_i, \text{state}_i)}{\bm{\Sigma}_\text{R}.\fnref[sigma]{Commitment}(w,\text{R})}$ commits witness $w$ for relation $\text{R}$
        \EndFor
        % \State Set $\assign{\vect{A}}{\{\g{A}_1,\dots,\g{A}_{\lambda/\ell}\}}$
        \For {$i \in \range{\lambda/\ell}$}
            \State Sample a challenge $\sample{e_i}{\{0,1\}^{\ell \log_2(\lambda)}}$
            \State $\assign{z_i}{\bm{\Sigma}_\text{R}.\fnref[sigma]{Response}(\text{state}_i, e_i)}$ as the response to that challenge.
            \State Check if $\isequal{\fn{H}_\ell(\{a_i\}_{\forall i} \concat i \concat e_i \concat z_i)}{\vect{0}_{\Z_2^\ell}}$, otherwise go back to step 6
        \EndFor
        \Statex \Return $(\pi \equals \{a_i,e_i, z_i\}_{\forall i})$
        
        
    \vspace{-8pt}
    \setalglineno{1}
    \AlgFnct{\fndef[fischlin]{Verify}}{}{$\text{R}, \pi\equals\{a_i, e_i, z_i\}_{i \in \range{\lambda/\ell}}$}{\textit{valid}}        
        \For {$i \in \range{\lambda/\ell}$}
            \State Check if $\isequal{\fn{H}_\ell(\{a_i\}_{\forall i} \concat i \concat e_i \concat z_i)}{\vect{0}_{\Z_2^\ell}}$, otherwise $\ABORT$
            \State Check if $\bm{\Sigma}_\text{R}.\fnref[sigma]{Verify}(x, z_i, e_i)$, otherwise $\ABORT$
        \EndFor
        \Statex \Return \textit{valid}
        
    \end{algorithmic}
\end{scheme}

\footnotetext{Typically instantiated via a standard hash function with truncated output, e.g., SHA-256.}