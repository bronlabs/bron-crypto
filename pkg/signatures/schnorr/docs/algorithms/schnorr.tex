\begin{scheme}[H]
    \caption{$\quad$\fndef{Schnorr}} \label{alg:schnorr}
    \begin{algorithmic}[1]
        \begin{alginfo}
            The Schnorr signature scheme~\cite{schnorr}, parametrized by an elliptic curve $\set{E}(\G, q, \g{G}, \g{I})$ with identity $\g{I}$, and a hash function \fn{H}. Following a prior \fnref[f_signature]{KeyGen}, the signer holds a private key $x \in \Z_q^{\star}$ and a public key $\g{Q} = x\cdot \g{G}$
        \end{alginfo} 

    \Require { $m$, a message to sign}

    \vspace{-10pt}
    \AlgFnctZero{\hspace{4pt}\fndef[schnorr]{Sign}}{}{$m,\;x\ins\Z_q^{\star},\; \g{Q}\ins\G$}{$\sigma$}
        \State Sample $\sample{k}{\Z_{q^*}}$ \Commentg{(Nonce generation)}
        \State $\assign{\g{R}}{k \cdot \g{G}}$ \Commentg{(Commitment)}
        \State $\assign{e}{\fn{H}( \g{R} \concat \g{Q} \concat m)}$ \Commentg{(Challenge)}
        \State $\assign{s}{(x \cdot e) + k}$ \Commentg{(Signature composition)}
        \Statex \Return $\sigma\equals\{e,s\}$ as the signature

    \vspace{-10pt}
    \setalglineno{1}
    \AlgFnct{\hspace{-4pt}\fndef[schnorr]{Verify}}{}{$m, \g{Q} \ins \G,\;\sigma \equals \{e\ins \Z_{q^*}, s \ins \Z_{q^*}\}$}{\textit{valid}}
        \State $\assign{\g{R}}{s \cdot \g{G} + (-e) \cdot \g{Q}}$
        \State $\assign{e'}{\fn{H}(\g{R} \concat \g{Q} \concat m)}$
        \State Check if $\isequal{e'}{e}$, otherwise $\ABORT$.
        \Statex \Return \textit{valid}
    \end{algorithmic}
\end{scheme}
