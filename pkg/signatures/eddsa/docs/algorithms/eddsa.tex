\begin{scheme}[H]
    \caption{$\quad$\fndef{EdDSA}} \label{alg:eddsa}
    \begin{algorithmic}[1]
        \begin{alginfo}
            The EdDSA signature scheme~\cite{schnorr} for \textit{ed25519}$(\G, q, \g{G}, \g{I})$ and hash function \fn{H} (often \fn{Sha512}). Signer run holds private key $x\in \Z_2^{|q|}$ and public key $\g{Q} \ins \G$.
        \end{alginfo} 

    \Require { $m$, a message to sign}

    \vspace{-10pt}
    \AlgFnctZero{\hspace{4pt}\fndef[eddsa]{KeyGen}}{}{}{$(x, \g{Q})$}
        \State Sample $\sample{a}{\{0,1\}^{2 |q|}}$
        \State $\assign{\g{Q}}{a \cdot \g{G}}$
        \State $\assign{x}{\{\vecti{a}{i+|q|}\}_{i\in \range{|q|}}}$
        \Statex \Return $(x, \g{Q})$ as the key pair

    \vspace{-10pt}
    \AlgFnct{\hspace{-4pt}\fndef[eddsa]{Sign}}{}{$m,\;x\ins\Z_q^{\star},\; \g{Q}\ins\G$}{$\sigma$}
        \State $\assign{k}{\fn{H}(x\concat m)}$ \Commentg{(Nonce generation)}
        \State $\assign{\g{R}}{k \cdot \g{G}}$ \Commentg{(Commitment)}
        \State $\assign{e}{\fn{H}(\g{R} \concat \g{Q} \concat \fn{H}(m))}$ \Commentg{(Challenge)}
        \State $\assign{s}{(x \cdot e) + k}$ \Commentg{(Signature composition)}
        \Statex \Return $\sigma\equals\{R,s\}$ as the signature

    \vspace{-10pt}
    \setalglineno{1}
    \AlgFnct{\hspace{-4pt}\fndef[eddsa]{Verify}}{}{$m, \g{Q} \ins \G,\;\sigma \equals \{R\ins \G, s \ins \Z_{q^*}\}$}{\textit{valid}}
        \State $\assign{e'}{\fn{H}(\g{G} \concat \g{R} \concat \g{Q} \concat \fn{H}(m))}$
        \State $\assign{\g{R}'}{s \cdot \g{G} + (-e) \cdot \g{Q}}$
        \State Check if $\isequal{\g{R}'}{\g{R}}$, otherwise $\ABORT$.
        \Statex \Return \textit{valid}
    \end{algorithmic}
\end{scheme}
