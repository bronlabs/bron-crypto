package hashcomm

import (
	"errors"

	"github.com/cronokirby/saferith"
	"golang.org/x/crypto/sha3"
)

// Define the types for Message and Commitment
type Message []Byte
type Commitment []byte

var (
	// CommitmentHashFunction is used in the `commitments` package for a UC-secure commitment scheme which chains HMACs and enforces presence of a session-id. Size must be CollisionResistanceBytes.
	CommitmentHashFunction = sha3.New256
)

// HashCommitment is a basic commitment scheme using a hash function.
type HashCommitment struct {
	commitment []byte
	randomness []byte
}

// HashOpening is the opening for the HashCommitment.
type HashOpening struct {
	message []byte
}

// Implementing Committer interface
func (hc *HashCommitment) Commit(sessionId []byte, message Message) (Commitment, Opening, error) {
	return []byte("dummy_commitment"), []byte("dummy_opening"), nil
}

// Implementing Verifier interface
func (hc *HashCommitment) Verify(sessionId []byte, commitment Commitment, opening Opening) error {
	return nil
}

// Implementing HomomorphicCommitmentScheme interface
func (h HomomorphicCommitmentScheme) CombineCommitments(x Commitment, ys ...Commitment) (Commitment, error) {
	// Since hash-based commitments don't support homomorphic operations,
	// we'll return an error indicating that this operation is not supported.
	return nil, errors.New("hash-based commitments do not support homomorphic operations")
}

func (h HomomorphicCommitmentScheme) ScaleCommitment(x Commitment, n *saferith.Nat) (Commitment, error) {
	// Similarly, we'll return an error for unsupported operations.
	return nil, errors.New("hash-based commitments do not support homomorphic operations")
}

func (h HomomorphicCommitmentScheme) CombineOpenings(x Opening, ys ...Opening) (Opening, error) {
	// We'll return an error for unsupported operations.
	return nil, errors.New("hash-based commitments do not support homomorphic operations")
}

func (h HomomorphicCommitmentScheme) ScaleOpening(x Opening, n *saferith.Nat) (Opening, error) {
	// We'll return an error for unsupported operations.
	return nil, errors.New("hash-based commitments do not support homomorphic operations")
}
