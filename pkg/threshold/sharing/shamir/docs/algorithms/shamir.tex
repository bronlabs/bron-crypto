
\begin{scheme}[H]
    \caption{$\quad\fn{Shamir \;Secret \;Sharing \;(SSS)}$} \label{alg:shamir}
    \begin{algorithmic}[1]
    \begin{alginfo}
        Shamir's Secret Sharing Scheme \cite{shamir} based on polynomial interpolation. This scheme is parametrized by a finite field $\F$, the number of shares produced $n$, and the number of shares required to reconstruct $t$ (threshold). 
    \end{alginfo}
    
    \vspace{-10pt}
    \AlgFnct{\fndef[shamir]{Split}}{t, n}{$s \ins \F$}{$(\vect{y})$}
        \State Set $\assign{\coeff{p}{0}}{s}$ as the constant term of a polynomial $\polyx{p}{x}$ of degree $t-1$.
        \For {$k \in \range{t-1}$}
            \State Sample $\sample{\coeff{p}{k}}{\F}$ as the random coefficients of the polynomial $\poly{p}$.
        \EndFor
        \For {$i \in \range{n}$}
            \State $\assign{\vecti{y}{i}}{\Sigma_{k=0}^{t-1} (\coeff{p}{k}\cdot i^{k})}$ as the evaluation of $\polyx{p}{x}$ in $x\equals i$.
        \EndFor
        \Statex \Return $(\vect{y}\equals\{\vecti{y}{i}\}_{i \in \range{n}})$ as the $n$ shares.

    \vspace{-10pt}
    \AlgFnct{\fndef[shamir]{Combine}}{t,n}{$\set{X} \in \subrange{t}{n}, \;\vect{y'}\equals\{\vecti{y}{i} \ins \F\}_{i \in \set{X}}$}{$s$}
    \setalglineno{1}
        \For{$i \in \set{X}$} \Comment{(Iterate over the indices of the $t$ shares)}
            \State Set $\assign{\set{X'}}{\set{X} \setminus \{i\}}$
            \State $\assign{\ell_i}{\Pi_{k \in \set{X'}} \frac{k}{k-i}}$ as the Lagrange coefficient $i$
        \EndFor
        \State $\assign{s}{\sum_{i \in \set{X}}\ell_i\cdot \vecti{y}{i}}$ for the Lagrange interpolation of $\polyx{p}{x}$ in $x\equals 0$.
        \Statex \Return $s$ as the reconstructed secret.
    \end{algorithmic}
\end{scheme}
