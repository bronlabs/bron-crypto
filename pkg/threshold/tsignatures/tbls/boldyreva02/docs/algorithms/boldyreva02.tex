
%TODO: Add message augmentation and POP as functionalities or at least descriptions.
\begin{protocol}[H]
    \caption{$\quad\fn{Boldyreva03}$}
    \label{alg:tbls}
    \begin{algorithmic}[1]
        \begin{alginfo}
            % \todo{Cleanup!}
            $t$-out-of-$n$ threshold signing protocol of \cite{boldyreva2003efficient}, realizing a distributed \fnref{BLS} signing scheme over elliptic curve BLS 123-81~\cite{irtf_bls_signature_05}, instantiated with short keys w.l.o.g. and employing rogue key prevention mechanisms. It uses $\fn{Sha256}$~\cite{FIPS1804} for hash functions $\fn{H}_{\G_1}$ and $\fn{H}_{\G_2}$ to output a random group elements in $\G_1$ and $\G_2$ respectively.
        \end{alginfo} 
        \Players {$t$ players out of the $n$ private-key share holders $\party{1}, \ldots, \party{n}$. At least one signature aggregator $\party{SA}$ (may be a share holder or a separate entity)}
        \Require {A unique session identifier $sid$, and a message $\vect{m}$ to be signed.}

        \Ensure {A partial signature $\sigma_i$ for each player $\party{i} \;\forall i \in \range{t}$ after round 1, and a signature $\sigma$ after aggregation, }

        \vspace{-8pt}
        \AlgRoundZero{$\party{i} \forall i \in \range{n}$}{Init}{}{}
            \State All $n$ parties jointly run $\fnref{DKG}$ to generate their signing key shares.
        
        \vspace{-8pt}
        \setalglineno{1}
        \AlgRound{$\party{i}$}{Sign}{$m$}{$\sigma_i$}
            \State Run $\assign{(\sigma_i, \pi_i)}{\fnref{BLS}.\fnref[bls]{Sign}(x_i, \vect{m})}$.
            \State $\sendTo{\party{SA}}{\sigma_i, \pi_i}$
        
        \vspace{-8pt}
        \setalglineno{1}
        \AlgRound{$\party{SA}$}{Aggregate}{$\{\sigma_i\}_{i \in \range{t}}$}{$\sigma$}
            \State Parse $\sigma_i$ and $\pi_i$ from all participating parties.
            \For{$i \in \range{t}$}
                \State Run steps 2-4 of $\fnref{BLS}.\fnref[bls]{Verify}(\g{Y}_i, \sigma_i)$.
            \EndFor
            \State $\sigma \gets \sum_{i \in \range{t}} \lambda_i \cdot \sigma_i$, where $\lambda_i$ is the Lagrange coefficient of $\party{i}$.
            \Statex \Return $\sigma$.

    \end{algorithmic}
\end{protocol}
