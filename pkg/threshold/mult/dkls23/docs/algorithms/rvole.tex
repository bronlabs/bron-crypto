\begin{protocol}[H]
    \caption{$\quad\fndef{RVOLE}_{\ell, q}$}
    \label{alg:rvole}
    \begin{algorithmic}[1]
        \begin{alginfo}
            A two-party protocol \cite[Protocol 5.2]{DKLS23} realizing the ${\idealfn{RVOLE}}_{q, \ell}$ random multiplicative to additive share generation with malicious security in a group $\G(q, \g{G})$, based on a $\fnref{ROTe}_{\xi,\ell}$ with batch-size $\xi\equals |q|+2\sigma$, a hash function $\fn{H}_{2\kappa}\!: \{0,1\}^* \!\mapsto \!\Z_2^\kappa$ and a hash-to-field function $\fn{H}_{\Z_q^{\ell \times \rho}}\!: \{0,1\}^* \!\mapsto\! \Z_q^{\ell \times \rho}$ with $\rho = \left\lceil |q| / \kappa \right\rceil$
        \end{alginfo} 
        \Players Alice $\party{A}$, and Bob $\party{B}$
        \Require {$\quad\party{A} \rightarrow \vect{a} \in \Z_q^\ell$;  $\quad\party{A} \& \party{B} \rightarrow \text{sid} \ins \{0,1\}^*$ as session id}

        \Ensure {$\party{A}\leftarrow \vect{c} \in \Z_q^\ell$ $\;\;\party{B}\leftarrow b\ins \Z_q, \vect{d} \ins \Z_q^\ell\;$ s.t. $\;\vecti{a}{i} \cdot b = \vecti{c}{i} + \vecti{d}{i}\;\; \forall i \ins \range{\ell}$}
        \vspace{-10pt}
        
        \AlgRoundZero{$\party{A} \& \party{B}$}{\fndef[rvole]{Setup}}{}{}
        \setalglineno{0}
            \State $\party{A}\&\party{B}$ run $\fnref{ROTe}.\fnref[rote]{Setup}()$ to generate $\kappa$ Base OT seeds for the $\binom{2}{1}\mhyphen \fn{ROTe}$ functionality with $\party{A}$ as sender $\mathcal{S}$ and $\party{B}$ as receiver $\mathcal{R}$
            \State Set an arbitrary public gadget vector $\vect{g} \ins \Z_q^\ell$
        
        \vspace{-8pt}
        \AlgRound{$\party{B}$}{\fndef[rvole]{Round1}}{}{$(\gamma, b)$}
        \setalglineno{1}
            \State Sample $\sample{\vect{\beta}}{\Z_2^\xi}$ as bob's ROTe choice bits
            \State Run $\assign{\vect{\gamma}}{\fnref{ROTe}.\fnref[rote]{Round1}(\vect{\beta})}$
            \State $\assign{b}{\sum_{j=1}^{\xi}\vecti{g}{j} \cdot \vecti{\beta}{i}}$
            \State $\sendTo{\party{A}}{\vect{\gamma}}$
            \Statex \Return $b$ as the multiplicative share of $\party{B}$

        \vspace{-8pt}
        \setalglineno{1}
            \AlgRound{$\party{A}$}{\fndef[rvole]{Round2}}{$\vect{\gamma}, \vect{a}$}{$(\vect{\tilde{a}}, \vect{\eta}, \mu, \vect{c})$}
            \State Run $\assign{(\vect{\alpha_0},\vect{\alpha_1})}{\fnref{ROTe}.\fnref[rote]{Round2}(\vect{\gamma})}$, where $\vect{\alpha_0},\vect{\alpha_1} \in \Z_q^{\xi\times (\ell +\rho)}$
            \State $\assign{\vect{c}}{\{\vecti{c}{i}\equals - \sum_{j=1}^{\xi}\vecti{\alpha_0}{j,i} \cdot \vecti{g}{j}\}_{i \in \range{\ell}}}$
            \State Sample $\sample{\vect{\hat{a}}}{\Z_q^\rho}$
            \State $\assign{\vect{\tilde{a}}}{\{\{\vecti{\alpha_0}{j,i} - \vecti{\alpha_1}{j,i} + \vecti{a}{i}\}_{i\in\range{\ell}} || \{\vecti{\alpha_0}{j,\ell+k} - \vecti{\alpha_1}{j,\ell+k} + \vecti{\hat{a}}{i}\}_{k\in\range{\rho}}\}_{j\in\range{\xi}}}$
            \State $\assign{\vect{\theta}}{\fn{H}_{\Z_q^{\ell \times \rho}}( \text{sid} \concat\vect{\tilde{a}})}$
            \State $\assign{\vect{\eta}}{\{\vecti{\hat{a}}{k} + \sum_{i=1}^{\ell}\vecti{\theta}{i, k} \cdot \vecti{a}{i}\}_{k\in\range{\rho}}}$
            \State $\assign{\vect{\mu}}{\{\{\vecti{\alpha_0}{j,\ell+k} + \sum_{i=1}^{\ell}\vecti{\theta}{i,k} \cdot \vecti{\alpha_0}{j,i}\}_{k\in\range{\rho}}\}_{j\in\range{\xi}}}$ 
            \State $\assign{\mu}{\fn{H}_{2\kappa}}{(\text{sid} \concat \vect{\mu})}$
            \State $\sendTo{\party{B}}{\vect{\tilde{a}}, \vect{\eta}, \mu}$
            \Statex \Return $\vect{c}$ as the output share of $\party{A}$
        
        \vspace{-8pt}
        \setalglineno{1}
        \AlgRound{$\party{B}$}{\fndef[rvole]{Round3}}{$\vect{\tilde{a}}, \vect{\eta}, \mu$}{$(\vect{z_B})$}
        % step 3.1: Î¸ <--- H_{â„¤q^{ð“xÏ}} (Ã£ || sid)
        \State $\assign{\vect{\theta}}{\fn{H}_{\Z_q^{\ell \times \rho}}(\text{sid} \concat \vect{\tilde{a}})}$
        % step 3.2: á¸‹_{j,i} = Î³_{j,i} + Î²_j * Ã£_{j,i}   âˆ€iâˆˆ[ð“] âˆ€jâˆˆ[Î¾]
        \State $\assign{\vect{\dot{d}}}{\{ 
        \{\vecti{\gamma}{j,i} + \vecti{\beta}{j} \cdot \vecti{\tilde{a}}{j,i}\}_{i\in\range{\ell}}\}_{j\in\range{\xi}}}$
        % step 3.3: d_i = âˆ‘_{jâˆˆ[Î¾]} g_j * á¸‹_{j,i} âˆ€iâˆˆ[ð“]
        \State $\assign{\vect{d}}{\{\sum_{j=1}^{\xi}\vecti{g}{j} \cdot \vecti{\dot{d}}{j,i}\}_{i\in\range{\ell}}}$
        % step 3.4: á¸“_{j,k} = Î³_{j,ð“+k} + Î²_j * Ã£_{j,l+k}   âˆ€kâˆˆ[Ï] âˆ€jâˆˆ[Î¾]
        \State $\assign{\vect{\hat{d}}}{\{\{\vecti{\gamma}{j,\ell+k} + \vecti{\beta}{j} \cdot \vecti{\tilde{a}}{j,\ell+k}\}_{k\in\range{\rho}}\}_{j\in\range{\xi}}}$
    	% step 3.5: Î¼b'_{j,k} = á¸“_{j,k} + âˆ‘_{iâˆˆ[ð“]} Î¸_{i*Ï + k} * á¸‹_{j,i} - Î²_j * Î·_k  âˆ€kâˆˆ[Ï] âˆ€jâˆˆ[Î¾]
        \State $\assign{\vect{\mu'}}{\{\{\vecti{\hat{d}}{j,k} + \sum_{i=1}^{\ell}\vecti{\theta}{i, k} \cdot \vecti{\dot{d}}{j,i} - \vecti{\beta}{j} \cdot \vecti{\eta}{k}\}_{k\in\range{\rho}}\}_{j\in\range{\xi}}}$
        % step 3.6: Î¼' = H_{â„¤2^{2*Î»_c}} (sid || Î¼b')
        \State $\assign{\mu'}{\fn{H}_{2\kappa}}{(\text{sid} \concat \vect{\mu'})}$
        % step 3.7: Check if Î¼' == Î¼, ABORT if not
        \State Check if $\isequal{\mu'}{\mu}$, {\ABORT} otherwise
        \Statex \Return $\vect{d}$ as the output share of $\party{B}$
    \end{algorithmic}
\end{protocol}