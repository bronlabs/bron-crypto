\begin{protocol}
    \caption{$\quad$\fndef{PedersenDKG}} \label{alg:pedersendkg}
    \begin{algorithmic}[1]
    \begin{alginfo}
        A Distributed Key Generation protocol from \cite{pedersen91dkg} using $t$-out-of-$n$ \fnref{Feldman} VSS and a ZKPoK of the discrete log (e.g., \fnref{Fischlin}), for a group $\G(q,\g{G})$
    \end{alginfo}
    \Players { $\party{1}, \dots,\party{i},\dots,\party{n}$, a set of $n$ share holders.}
    \Require $sid$, a unique session identifier (e.g., obtained from Protocol \ref{alg:agreeonrandom})
    \Ensure A public key $\g{Y}$ and $n$ secret shares $x_i$ of the private key $x$.
    \vspace{-11pt}
    \AlgRoundZero{\hspace{-2pt}$\party{i}$}{\fndef[pedersendkg]{Round1}}{}{$(\vect{x}_i, \vect{\g{C}}_i)$}
       \State Sample $\sample{a_{i,0}}{\Z_q}$
       \State $\assign{(\vect{x}_i,\vect{\g{C}}_i)}{\fnref{Feldman}.\fnref[feldman]{Split}(a_{i,0})}$ as shares $\vect{x}_i$ and public key shares $\vect{\g{C}}_i$
       \State $\assign{\mathit{\pi}_i}{\{\fn{Fischlin.Prove}(s)\} \; \forall s \ins \{a_{i,0}, \vecti{x}{i,1},\dots, \vecti{x}{i,n}\}}$
       \State $\sendTo{\party{j}}{\vecti{x}{i,j}}\;\;\forall j \ins \range{n}$
       \State $\idealfnref{Broadcast}(\vect{\g{C}}_i)$

    \vspace{-11pt}
    \setalglineno{1}
    \AlgRound{\hspace{-2pt}$\party{i}$}{\fndef[pedersendkg]{Round2}}{$\{\vect{\g{C}}_j, \mathit{\pi}_j\}_{j\in\range{n}}$}{($x_i, \g{Y}$)}
        \State Run $\fnref{Feldman}.\fnref[feldman]{Verify}(j, \vecti{x}{j,i}, \vect{\g{C}}_j)\;\;\forall j \ins \range{n}$; $\ABORT$ if it fails
        \State Run $\fnref{Fischlin}.\fnref[fischlin]{Verify}(j, \vect{\pi}_j) \;\;\forall j \ins \range{n}$; $\ABORT$ if it fails
        \State $\assign{x_i}{\sum_{j=1}^{n} \vecti{x}{j,i}}$ as the secret key share of $\party{i}$
        \State $\assign{\g{Y}}{\sum_{j=1}^{n} \vect{\g{C}}_{(j,0)}}$ as the public key
        \Statex \Return $(x_i, \g{Y})$
    \end{algorithmic}
\end{protocol}
    