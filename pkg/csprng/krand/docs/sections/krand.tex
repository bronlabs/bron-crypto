\inputAlgorithm{csprng/krand}{krand.tex}

We employ \fnref{krand} as the main CSPRNG for all our primitives and protocols. From this point onwards, we denote $\sample{r}{\Z_q}$ to represent $\assign{r}{\fnref{krand}.\fn{Sample}(|q|)}$, uniformly sampling a value $r$ from a set ($\Z_q$ in this example) by using an instance of \fnref{krand}. In cases where $q$ is not a power of two, an unless specified otherwise\footnote{Non-constant-time implementations might avoid this,  resorting instead to \textit{rejection sampling}: sampling a bit-string $r \in \Z_{2^{|q|}}$ of bit-length $|q|$ as many times as needed until $r>q$} we sample a sufficiently large number $\sample{r}{\Z_{2^{|q|+\kappa}}}$ and reduce it $\assign{r}{r'\mod q}$ at the cost of some acceptably low bias ($\approx 2^{-\kappa}$). We tested the quality of all our CSPRNGs with the test suite TestU01~\cite{l2007testu01}, passing all tests.